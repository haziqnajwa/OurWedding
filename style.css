/* style.css */
*{margin:0;padding:0;box-sizing:border-box}

:root{
  --pageW:1240;
  --pageH:1748;

  --vpad:18px;
  --radius:22px;

  /* Card placement (inside red square on card_bg.webp) */
  --slot-left:10.7%;
  --slot-top:6.7%;
  --slot-width:79.0%;
  --slot-height:84.8%;

  /* DOA text area (yellow box) */
  --doa-left:22%;
  --doa-top:14.5%;
  --doa-width:56%;
  --doa-height:27%;

  /* RSVP buttons (moved lower so it doesn't cover "Reception") */
  --rsvp-left:18%;
  --rsvp-width:64%;
  --rsvp-top1:62%;
  --rsvp-top2:71%;
  --rsvp-height:8%;

  /* Countdown placement (red area, under "COUNTDOWN") */
  --cd-left:8%;
  --cd-top:20%;
  --cd-width:84%;
  --cd-height:18%;

  /* Gallery photo viewport inside the white frame:
     moved down under "Gallery" and kept above seal */
  --gal-left:13%;
  --gal-top:22%;
  --gal-width:74%;
  --gal-height:52%;

  /* Cinematic Malay Vintage controls */
  --vintage-sepia: .12;          /* 0 to 0.25 */
  --vintage-vignette: .48;       /* 0 to 0.70 */
  --grain-opacity: .20;          /* 0 to 0.35 */
  --sparkle-opacity: .30;        /* 0 to 0.45 */
  --lightleak-opacity: .18;      /* 0 to 0.30 */
  --scratch-opacity: .08;        /* 0 to 0.18 */
}

body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:url("bg_red.webp") center/cover no-repeat;
  background-attachment: scroll;
  overflow-x:hidden;
}

@media (min-width: 900px){
  body{ background-attachment: fixed; }
}

body.locked{
  height:100vh;
  overflow:hidden;
}

.hidden{display:none!important}
.lockedContent{display:none}

/* Slides */
.slides{scroll-snap-type:y mandatory}
.slide{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:var(--vpad);
  scroll-snap-align:start;

  content-visibility:auto;
  contain-intrinsic-size: 100vh;
}

/* Stage: fixed aspect, responsive */
.stage{
  width:min(96vw,calc((100vh - (2*var(--vpad)))*(var(--pageW)/var(--pageH))));
  aspect-ratio:var(--pageW)/var(--pageH);
  position:relative;
  border-radius:var(--radius);
  overflow:hidden;
  box-shadow:0 20px 60px rgba(0,0,0,.22);

  contain: layout paint;
  isolation:isolate; /* important for blend modes */
}

.stageMedia{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
  position:relative;
  z-index:1;
}

.overlay{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:4;
}

/* ---------- Cinematic Malay Vintage Overlay (STRONGER) ---------- */

/* 1) VIGNETTE + WARM VINTAGE TONE */
.stage::before{
  content:"";
  position:absolute;
  inset:-1px;
  pointer-events:none;
  z-index:2;

  background:
    radial-gradient(ellipse at center,
      rgba(255,245,230,0.06) 0%,
      rgba(255,245,230,0.02) 45%,
      rgba(0,0,0,var(--vintage-vignette)) 100%
    ),
    linear-gradient(180deg,
      rgba(255,244,225,var(--vintage-sepia)) 0%,
      rgba(120,50,30,0.06) 100%
    );

  mix-blend-mode:multiply;
  opacity:1;
}

/* 2) FILM GRAIN + SPARKLES + SCRATCHES + LIGHT LEAKS */
.stage::after{
  content:"";
  position:absolute;
  inset:-1px;
  pointer-events:none;
  z-index:3;

  background:
    /* Light leaks (warm glow) */
    radial-gradient(circle at 18% 12%,
      rgba(255,210,160,var(--lightleak-opacity)) 0%,
      rgba(255,210,160,0) 45%
    ),
    radial-gradient(circle at 85% 22%,
      rgba(255,190,140,calc(var(--lightleak-opacity)*0.75)) 0%,
      rgba(255,190,140,0) 55%
    ),

    /* Sparkles / dust (white) */
    radial-gradient(circle at 12% 22%, rgba(255,255,255,var(--sparkle-opacity)) 0 1.2px, transparent 2.8px),
    radial-gradient(circle at 24% 68%, rgba(255,255,255,calc(var(--sparkle-opacity)*.70)) 0 1.0px, transparent 2.4px),
    radial-gradient(circle at 44% 35%, rgba(255,255,255,calc(var(--sparkle-opacity)*.85)) 0 1.1px, transparent 2.7px),
    radial-gradient(circle at 62% 18%, rgba(255,255,255,calc(var(--sparkle-opacity)*.65)) 0 1.0px, transparent 2.3px),
    radial-gradient(circle at 78% 52%, rgba(255,255,255,calc(var(--sparkle-opacity)*.80)) 0 1.2px, transparent 2.8px),
    radial-gradient(circle at 88% 78%, rgba(255,255,255,calc(var(--sparkle-opacity)*.60)) 0 0.9px, transparent 2.1px),

    /* Film grain */
    repeating-linear-gradient(0deg,
      rgba(255,255,255,var(--grain-opacity)) 0 1px,
      rgba(0,0,0,calc(var(--grain-opacity)*.55)) 2px 3px
    ),
    repeating-linear-gradient(90deg,
      rgba(255,255,255,calc(var(--grain-opacity)*.55)) 0 1px,
      rgba(0,0,0,calc(var(--grain-opacity)*.40)) 2px 3px
    ),

    /* Light scratches */
    repeating-linear-gradient(90deg,
      rgba(255,255,255,var(--scratch-opacity)) 0 1px,
      rgba(255,255,255,0) 16px 34px
    );

  background-size:
    160% 160%,
    170% 170%,
    100% 100%,
    100% 100%,
    100% 100%,
    100% 100%,
    100% 100%,
    100% 100%,
    260px 260px,
    320px 320px,
    520px 520px;

  mix-blend-mode:screen;
  opacity:1;
  filter: blur(.12px);

  animation:
    vintageDrift 12s ease-in-out infinite,
    sparkleTwinkle 3.8s ease-in-out infinite;
}

@keyframes vintageDrift{
  0%   { transform: translate3d(0,0,0) scale(1.01); }
  40%  { transform: translate3d(-6px, 8px,0) scale(1.015); }
  75%  { transform: translate3d(6px, -5px,0) scale(1.01); }
  100% { transform: translate3d(0,0,0) scale(1.01); }
}

@keyframes sparkleTwinkle{
  0%,100% { opacity: 0.92; }
  50%     { opacity: 1; }
}

@media (prefers-reduced-motion: reduce){
  .stage::after{ animation:none; }
}

/* Opening */
.openingSection{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:var(--vpad);
}

.openHit{
  position:absolute;
  inset:0;
  border:none;
  background:transparent;
  cursor:pointer;
  display:flex;
  align-items:flex-end;
  justify-content:center;
  padding:20px;
  z-index:5;
  pointer-events:auto;
}

.tapText{
  background:rgba(0,0,0,.4);
  color:#fff;
  padding:10px 18px;
  border-radius:999px;
  font-weight:900;
}

/* Music */
.musicBtn{
  position:fixed;
  right:18px;
  bottom:18px;
  width:56px;
  height:56px;
  border-radius:50%;
  border:none;
  background:#fff;
  cursor:pointer;
  z-index:50;
}

/* Card flip */
.cardSlot{
  position:absolute;
  left:var(--slot-left);
  top:var(--slot-top);
  width:var(--slot-width);
  height:var(--slot-height);
  perspective:1200px;
  overflow:hidden;
  pointer-events:auto;
}

.flipWrap{
  width:100%;
  height:100%;
  border:none;
  background:none;
  cursor:pointer;
  padding:0;
}

.flipCard{
  width:100%;
  height:100%;
  position:relative;
  transform-style:preserve-3d;
  transition:transform .9s cubic-bezier(.2,.85,.2,1);
  will-change: transform;
}

.flipCard.isFlipped{transform:rotateY(180deg)}

.flipFace{
  position:absolute;
  inset:0;
  backface-visibility:hidden;
}

.flipBack{transform:rotateY(180deg)}

.flipFace img{
  width:100%;
  height:100%;
  object-fit:cover;
  transform:scale(1.10);
}

/* RSVP */
.rsvpOverlay{
  position:absolute;
  left:var(--rsvp-left);
  width:var(--rsvp-width);
  top:0;
  height:100%;
  pointer-events:auto;
}

.rsvpBtn{
  position:absolute;
  left:0;
  width:100%;
  height:var(--rsvp-height);
  display:flex;
  align-items:center;
  justify-content:center;
  text-decoration:none;
  font-weight:800;
  color:#5b0b0b;
  background:rgba(255,255,255,.92);
  border-radius:999px;
  box-shadow:0 10px 25px rgba(0,0,0,.18);
}

#mapLink{top:var(--rsvp-top1)}
#rsvpLink{top:var(--rsvp-top2)}

/* Countdown */
.countdownOverlay{
  position:absolute;
  left:var(--cd-left);
  top:var(--cd-top);
  width:var(--cd-width);
  height:var(--cd-height);
  display:flex;
  align-items:flex-end;
  justify-content:center;
  pointer-events:none;
}

.countdownRow{
  width:100%;
  display:flex;
  gap:clamp(10px,2vw,22px);
  justify-content:space-between;
  align-items:flex-end;
}

.cdItem{flex:1;text-align:center}

.cdNum{
  font-weight:900;
  font-size:clamp(26px,4.2vw,56px);
  line-height:1;
  color:#fff;
  text-shadow:0 10px 25px rgba(0,0,0,.35);
}

.cdLbl{
  margin-top:6px;
  font-weight:900;
  letter-spacing:.08em;
  font-size:clamp(10px,1.2vw,14px);
  color:rgba(255,255,255,.92);
}

/* Gallery */
.galleryOverlay{
  position:absolute;
  left:0; top:0; width:100%; height:100%;
  pointer-events:auto;
}

.galleryViewport{
  position:absolute;
  left:var(--gal-left);
  top:var(--gal-top);
  width:var(--gal-width);
  height:var(--gal-height);
  overflow:hidden;
  border-radius:18px;
}

.galleryViewport img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

.fadeIn{animation:fadeIn .22s ease-out}
@keyframes fadeIn{from{opacity:.25;transform:scale(.99)}to{opacity:1;transform:scale(1)}}

.galleryArrow{
  position:absolute;
  top:calc(var(--gal-top) + (var(--gal-height)/2));
  transform:translateY(-50%);
  width:44px;
  height:44px;
  border:none;
  border-radius:50%;
  cursor:pointer;
  background:rgba(255,255,255,.86);
  color:#4b0b0b;
  font-size:30px;
  line-height:44px;
  text-align:center;
  box-shadow:0 10px 25px rgba(0,0,0,.18);
}

.galleryArrow.left{left:calc(var(--gal-left) - 18px)}
.galleryArrow.right{left:calc(var(--gal-left) + var(--gal-width) - 26px)}

.galleryDots{
  position:absolute;
  left:0;
  right:0;
  top:calc(var(--gal-top) + var(--gal-height) + 1.5%);
  display:flex;
  justify-content:center;
  gap:10px;
  pointer-events:auto;
}

.dot{
  width:10px;height:10px;border-radius:50%;
  border:none;
  background:rgba(255,255,255,.55);
  cursor:pointer;
}
.dot.active{background:rgba(255,255,255,.95)}

/* DOA TEXT */
.doaOverlay{
  position:absolute;
  left:var(--doa-left);
  top:var(--doa-top);
  width:var(--doa-width);
  height:var(--doa-height);
  overflow:hidden;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  pointer-events:none;
}

.doaType{
  width:100%;
  height:100%;
  white-space:pre-wrap;
  overflow-wrap:anywhere;
  text-align:center;
  font-weight:800;
  line-height:1.35;
  color:#2b0b0b;
  font-size:14px;
  text-shadow:0 1px 0 rgba(255,255,255,.6);

  /* start hidden (fade in when slide is reached) */
  opacity:0;
  transform:translateY(10px);
}

.slide.isDoaActive .doaType{
  animation: doaFadeIn .9s ease-out forwards;
}

@keyframes doaFadeIn{
  to{ opacity:1; transform:translateY(0); }
}

/* Slightly larger tap targets on small screens */
@media (max-width:520px){
  :root{
    --vpad:12px;
    --rsvp-height:9%;
  }
  .galleryArrow{width:40px;height:40px;line-height:40px;font-size:28px}
}
